<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        
        <link rel="canonical" href="http://farmos.org/guide/assets/sensors/">
        <link rel="shortcut icon" href="../../../img/favicon.ico">
        <title>Sensors - farmOS.org</title>
        <link href="../../../css/bootstrap-custom.min.css" rel="stylesheet">
        <link href="../../../css/font-awesome.min.css" rel="stylesheet">
        <link href="../../../css/base.css" rel="stylesheet">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/color-brewer.min.css">
        <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
        <!--[if lt IE 9]>
            <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
            <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
        <![endif]-->

        <script src="../../../js/jquery-1.10.2.min.js" defer></script>
        <script src="../../../js/bootstrap-3.0.3.min.js" defer></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
        <script>hljs.initHighlightingOnLoad();</script>
        <script>
            (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
            (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
            m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
            })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

            ga('create', 'UA-56974603-1', 'farmos.org');
            ga('send', 'pageview');
        </script> 
    </head>

    <body>

        <div class="navbar navbar-default navbar-fixed-top" role="navigation">
            <div class="container">

                <!-- Collapsed navigation -->
                <div class="navbar-header">
                    <!-- Expander button -->
                    <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                        <span class="sr-only">Toggle navigation</span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                    </button>
                    <a class="navbar-brand" href="../../..">farmOS.org</a>
                </div>

                <!-- Expanded navigation -->
                <div class="navbar-collapse collapse">
                        <!-- Main navigation -->
                        <ul class="nav navbar-nav">
                            <li class="dropdown active">
                                <a href="#" class="dropdown-toggle" data-toggle="dropdown">User Guide <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li >
    <a href="../../">Introduction</a>
</li>
                                    
<li >
    <a href="../../areas/">Mapping your farm</a>
</li>
                                    
<li >
    <a href="../../logs/">Logging events</a>
</li>
                                    
  <li class="dropdown-submenu">
    <a href="#">Managing assets</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../">Introduction</a>
</li>
            
<li >
    <a href="../plantings/">Plantings</a>
</li>
            
<li >
    <a href="../animals/">Animals</a>
</li>
            
<li >
    <a href="../equipment/">Equipment</a>
</li>
            
<li >
    <a href="../compost/">Compost</a>
</li>
            
<li class="active">
    <a href="./">Sensors</a>
</li>
            
<li >
    <a href="../groups/">Groups</a>
</li>
    </ul>
  </li>
                                    
<li >
    <a href="../../location/">Movements and location</a>
</li>
                                    
<li >
    <a href="../../quantity/">Quantity measurements</a>
</li>
                                    
<li >
    <a href="../../inventory/">Inventory tracking</a>
</li>
                                    
<li >
    <a href="../../people/">People</a>
</li>
                                    
<li >
    <a href="../../import/">Import</a>
</li>
                                    
<li >
    <a href="../../export/">Export</a>
</li>
                                    
<li >
    <a href="../../quick/">Quick forms</a>
</li>
                                    
  <li class="dropdown-submenu">
    <a href="#">Community modules</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../../contrib/">Introduction</a>
</li>
            
<li >
    <a href="../../contrib/eggs/">Eggs</a>
</li>
            
<li >
    <a href="../../contrib/nutrient/">Nutrient</a>
</li>
            
<li >
    <a href="../../contrib/organic/">Organic</a>
</li>
            
<li >
    <a href="../../contrib/produce-safety/">Produce Safety</a>
</li>
    </ul>
  </li>
                                </ul>
                            </li>
                            <li class="dropdown">
                                <a href="#" class="dropdown-toggle" data-toggle="dropdown">Hosting <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li >
    <a href="../../../hosting/">Getting started</a>
</li>
                                    
<li >
    <a href="../../../hosting/installing/">Installing</a>
</li>
                                    
<li >
    <a href="../../../hosting/updating/">Updating</a>
</li>
                                    
<li >
    <a href="../../../hosting/googlemaps/">Google Maps</a>
</li>
                                    
<li >
    <a href="../../../hosting/docker/">Docker</a>
</li>
                                </ul>
                            </li>
                            <li class="dropdown">
                                <a href="#" class="dropdown-toggle" data-toggle="dropdown">Development <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li >
    <a href="../../../development/drupal/">Drupal</a>
</li>
                                    
<li >
    <a href="../../../development/projects/">Projects</a>
</li>
                                    
<li >
    <a href="../../../development/issue-queues/">Issue Queues</a>
</li>
                                    
<li >
    <a href="../../../development/architecture/">Architecture</a>
</li>
                                    
<li >
    <a href="../../../development/update-safety/">Update Safety</a>
</li>
                                    
<li >
    <a href="../../../development/docker/">Docker</a>
</li>
                                    
<li >
    <a href="../../../development/api/">API</a>
</li>
                                    
<li >
    <a href="../../../development/client/">Client</a>
</li>
                                    
<li >
    <a href="../../../development/release/">Release procedure</a>
</li>
                                </ul>
                            </li>
                            <li class="dropdown">
                                <a href="#" class="dropdown-toggle" data-toggle="dropdown">Community <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li >
    <a href="../../../community/contribute/">Contribute</a>
</li>
                                    
<li >
    <a href="../../../community/monthly-call/">Monthly Call</a>
</li>
                                    
<li >
    <a href="../../../community/farms/">Farms</a>
</li>
                                    
<li >
    <a href="../../../community/maintainers/">Maintainers</a>
</li>
                                    
<li >
    <a href="../../../community/supporters/">Supporters</a>
</li>
                                    
<li >
    <a href="../../../community/press/">Press</a>
</li>
                                    
<li >
    <a href="../../../community/trademark/">Trademark</a>
</li>
                                </ul>
                            </li>
                            <li >
                                <a href="../../../faq/">FAQ</a>
                            </li>
                            <li >
                                <a href="../../../donate/">Donate</a>
                            </li>
                        </ul>

                    <ul class="nav navbar-nav navbar-right">
                        <li>
                            <a href="#" data-toggle="modal" data-target="#mkdocs_search_modal">
                                <i class="fa fa-search"></i> Search
                            </a>
                        </li>
                            <li >
                                <a rel="next" href="../compost/">
                                    <i class="fa fa-arrow-left"></i> Previous
                                </a>
                            </li>
                            <li >
                                <a rel="prev" href="../groups/">
                                    Next <i class="fa fa-arrow-right"></i>
                                </a>
                            </li>
                            <li>
                                <a href="https://github.com/farmOS/edit/master/docs/guide/assets/sensors.md"><i class="fa fa-github"></i> Edit on GitHub</a>
                            </li>
                    </ul>
                </div>
            </div>
        </div>

        <div class="container">
                <div class="col-md-3"><div class="bs-sidebar hidden-print affix well" role="complementary">
    <ul class="nav bs-sidenav">
        <li class="main active"><a href="#sensors">Sensors</a></li>
            <li><a href="#farm-sensor-listener">Farm Sensor: Listener</a></li>
    </ul>
</div></div>
                <div class="col-md-9" role="main">

<h1 id="sensors">Sensors<a class="headerlink" href="#sensors" title="Permanent link">&para;</a></h1>
<p>In addition to manually-entered records, farmOS also provides a framework for
receiving data from automated environmental sensors. The <em>Farm Sensor</em> module
adds a <strong>Sensor</strong> <a href="/guide/assets">asset</a> type, which can be tracked like any
other asset.</p>
<p>Sub-modules (like <em>Farm Sensor: Listener</em>) extend the Sensor asset type by
providing integration with external devices. Additional modules can be built to
connect to specific types of sensors, if necessary.</p>
<p>It is possible to assemble your own sensors with inexpensive components and
send their data to farmOS without any soldering or programming.</p>
<video width="100%" controls>
  <source src="/demo/sensors.mp4" type="video/mp4">
</video>

<h2 id="farm-sensor-listener">Farm Sensor: Listener<a class="headerlink" href="#farm-sensor-listener" title="Permanent link">&para;</a></h2>
<p>The <em>Farm Sensor: Listener</em> module is a general-purpose sensor sub-module that
provides a simple "Listener" sensor type. Each sensor asset that is denoted as
a listener receives a unique URL with a public and private key that data can be
pushed to using standard <a href="https://en.wikipedia.org/wiki/Hypertext_Transfer_Protocol">HTTP</a> requests with <a href="https://en.wikipedia.org/wiki/JSON">JSON</a>-encoded data. Data is
stored in the database and is displayed in the sensor asset within farmOS.</p>
<p>The listener module is useful for simple data streams. For more complex data, a
more customized sub-module may be necessary.</p>
<h3 id="posting-data-to-a-listener">Posting data to a listener<a class="headerlink" href="#posting-data-to-a-listener" title="Permanent link">&para;</a></h3>
<p>Data can be posted to the listener using a standard <a href="https://en.wikipedia.org/wiki/Hypertext_Transfer_Protocol">HTTP</a> request.</p>
<p>Each sensor will have a unique URL endpoint, which contains both the public key
(as part of the address), and the private key (as a URL query paramter). This
can be found in the configuration settings for the sensor asset within farmOS.</p>
<p><em>It is recommended that you serve farmOS over an HTTPS connection, so that the
keys are encrypted in transit.</em></p>
<p><strong>URL example:</strong> <code>https://myfarm.farmos.net/farm/sensor/listener/xxxxxx?private_key=yyyyyy</code></p>
<p>The endpoint expects a JSON object with name/value pairs, and an optional
timestamp.</p>
<p><strong>JSON example:</strong> <code>{ "timestamp": 1541519720, "value": 76.5 }</code></p>
<p>If the timestamp is omitted, farmOS will assign the data a timestamp based on
the time that the request is received.</p>
<p><strong>JSON without timestamp:</strong> <code>{ "value": 76.5 }</code></p>
<p>Multiple sensor values can be included in each request (if a device measures
more than one metric, for example). The name given to each value can be any
string of numbers and letters other than "timestamp", which is reserved. Each
name/value pair will be stored in a separate row in the database.</p>
<p><strong>JSON with multiple values:</strong> <code>{ "timestamp": 1541519720, "temperature": 76.5, "humidity": 60 }</code></p>
<p>The following <code>curl</code> command demonstrates how to post simple data to a sensor
from the command-line.</p>
<pre><code>curl -H &quot;Content-Type: application/json&quot; -X POST \
-d '{ &quot;timestamp&quot;: 1541519720, &quot;value&quot;: 76.5 }' \
https://myfarm.farmos.net/farm/sensor/listener/xxxxxx?private_key=yyyyyy
</code></pre>

<h3 id="pulling-data-from-a-listener">Pulling data from a listener<a class="headerlink" href="#pulling-data-from-a-listener" title="Permanent link">&para;</a></h3>
<p>Data can also be retrived from the sensor via the same API endpoint, using a
<code>GET</code> request instead of a <code>POST</code> request. The URL is the same as the URL for
posting data.</p>
<p><strong>URL example:</strong> <code>https://myfarm.farmos.net/farm/sensor/listener/xxxxxx?private_key=yyyyyy</code></p>
<p>The private key must be included, unless public API read access is allowed (see
below).</p>
<p>Only the most recent data point will be returned, unless additional query
parameters are provided for limiting/filtering the data. Available parameters
include:</p>
<ul>
<li><code>name</code>: Filter to data with a matching name.</li>
<li><code>start</code>: Filter data to timestamps greater than or equal to this start
  timestamp.</li>
<li><code>end</code>: Filter data to timestamps less than or equal to this end timestamp.</li>
<li><code>limit</code>: The number of results to return.</li>
<li><code>offset</code>: The value to start at.</li>
</ul>
<p><strong>Example filtered by name:</strong> <code>https://myfarm.farmos.net/farm/sensor/listener/xxxxxx?private_key=yyyyyy&amp;name=temperature</code></p>
<p><strong>Allowing public API read access</strong></p>
<p>Data in farmOS is private by default. A private key is required to push data to
a sensor, and by default the same key is also required to pull data.</p>
<p>If you want to access your sensor data outside of farmOS, you should be careful
not to leak your private key, because that would allow anyone to post data to
your sensor.</p>
<p>One area where this is of particular concern is one in which you want to use a
client-side language like JavaScript to pull sensor data for display on a
public web page (eg: in a graph you develop yourself). Doing so runs the risk
of exposing your private key, if it is included in the client-side code that
is publicly visible. To allow for this use-case, you can choose to make your
sensor data itself publicly available.</p>
<p>Listener sensors have an optional configuration setting to "Allow public API
read access". Enabling this will allow data from the sensor to be queried
publicly via the API endpoint without a private key.</p>
<p><em>This setting will make the data available to anyone who knows the farmOS URL
and sensor public key.</em></p>
<p>If more privacy is needed, it is recommended that the sensor be kept private,
and server-side API requests are used instead of client-side code.</p>
<h3 id="grovepi-node-red">GrovePi + Node Red<a class="headerlink" href="#grovepi-node-red" title="Permanent link">&para;</a></h3>
<p>If you are looking for a DIY approach to collecting sensor data that doesn't
require soldering or coding check out this guide to
<a href="http://farmhack.org/tools/collecting-sensor-data-farmos-using-grovepi-and-node-red">Collecting sensor data in farmOS using GrovePi and Node-RED</a>
on <a href="http://farmhack.org">Farm Hack</a>.</p>
<iframe width="100%" height="480" src="https://www.youtube.com/embed/rCl06YBb4cM" frameborder="0" allowfullscreen></iframe>

<h3 id="open-pipe-kit">Open Pipe Kit<a class="headerlink" href="#open-pipe-kit" title="Permanent link">&para;</a></h3>
<p>The <a href="http://openpipekit.github.io">Open Pipe Kit</a> project provides a command-line script that can be used to
push data to farmOS from various sensors using the <em>Farm Sensor: Listener</em>
module. The following video demonstrates how to set it up. For more information
about Open Pipe Kit, refer to: <a href="http://openpipekit.github.io">http://openpipekit.github.io</a></p>
<p>Open Pipe Kit farmOS CLI: <a href="https://github.com/openpipekit/farmos-cli">https://github.com/openpipekit/farmos-cli</a></p>
<iframe width="100%" height="480" src="https://www.youtube.com/embed/fCflGeOpTqk" frameborder="0" allowfullscreen></iframe>

<h3 id="notifications">Notifications<a class="headerlink" href="#notifications" title="Permanent link">&para;</a></h3>
<p>The <em>Farm Sensor: Listener</em> module comes with a basic alert notification
mechanism that can be configured to send an email or text message if an
incoming value is above or below a given threshold.</p>
<p><strong>Text messages:</strong> It is possible to send text messages by entering a special
email address that corresponds to your phone number and mobile carrier.</p>
<p>Here are the domain names used for some of the more popular phone carriers:</p>
<ul>
<li>US Cellular: <code>[number]@email.uscc.net</code></li>
<li>Verizon: <code>[number]@vtext.com</code></li>
<li>Virgin: <code>[number]@vmobl.com</code></li>
<li>AT&amp;T: <code>[number]@txt.att.net</code></li>
<li>Nextel: <code>[number]@messaging.nextel.com</code></li>
<li>Sprint: <code>[number]@messaging.sprintpcs.com</code></li>
<li>T-Mobile: <code>[number]@tmomail.net</code></li>
<li>republic wirelsss: <code>[number]@text.republicwireless.com</code></li>
</ul>
<p>Use the phone number of the person you are texting followed by the domain name
corresponding to their carrier. For example, if you are sending a text message
to a Nextel subscriber with the phone number <code>232-232-2323</code>, you would enter
<code>2322322323@messaging.nextel.com</code>.</p></div>
        </div>

        <footer class="col-md-12">
            <hr>
                <p><p><a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/4.0/"><img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by-nc-sa/4.0/88x31.png" /></a><br /><span xmlns:dct="http://purl.org/dc/terms/" property="dct:title">farmOS.org</span> content is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/4.0/">Creative Commons Attribution-NonCommercial-ShareAlike 4.0 International License</a>.<br />farmOS is a <a href="/community/trademark">registered trademark</a> of <a href="http://mstenta.net">Michael Stenta</a></p><p><a href="/donate">Donate</a> to help support the farmOS project.</p>.</p>
            <p>Documentation built with <a href="https://www.mkdocs.org/">MkDocs</a>.</p>
        </footer>
        <script>
            var base_url = "../../..",
                shortcuts = {"help": 191, "previous": 80, "search": 83, "next": 78};
        </script>
        <script src="../../../js/base.js" defer></script>
        <script src="../../../search/main.js" defer></script>

        <div class="modal" id="mkdocs_search_modal" tabindex="-1" role="dialog" aria-labelledby="Search Modal" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
                <h4 class="modal-title" id="exampleModalLabel">Search</h4>
            </div>
            <div class="modal-body">
                <p>
                    From here you can search these documents. Enter
                    your search terms below.
                </p>
                <form role="form">
                    <div class="form-group">
                        <input type="text" class="form-control" placeholder="Search..." id="mkdocs-search-query" title="Type search term here">
                    </div>
                </form>
                <div id="mkdocs-search-results"></div>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div><div class="modal" id="mkdocs_keyboard_modal" tabindex="-1" role="dialog" aria-labelledby="Keyboard Shortcuts Modal" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
                <h4 class="modal-title" id="exampleModalLabel">Keyboard Shortcuts</h4>
            </div>
            <div class="modal-body">
              <table class="table">
                <thead>
                  <tr>
                    <th style="width: 20%;">Keys</th>
                    <th>Action</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td class="help shortcut"><kbd>?</kbd></td>
                    <td>Open this help</td>
                  </tr>
                  <tr>
                    <td class="next shortcut"><kbd>n</kbd></td>
                    <td>Next page</td>
                  </tr>
                  <tr>
                    <td class="prev shortcut"><kbd>p</kbd></td>
                    <td>Previous page</td>
                  </tr>
                  <tr>
                    <td class="search shortcut"><kbd>s</kbd></td>
                    <td>Search</td>
                  </tr>
                </tbody>
              </table>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div>

    </body>
</html>
